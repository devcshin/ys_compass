<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ìœ„ì¹˜ ê³µìœ  ë°ëª¨</title>
  <script src="https://www.gstatic.com/firebasejs/12.1.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.1.0/firebase-database-compat.js"></script>
</head>
<body>
  <h1>ìœ„ì¹˜ ê³µìœ  ë°ëª¨ (ìˆ˜í”¼ë°”ë¼ì˜ ë°©í–¥)</h1>
  <button onclick="uploadLocation()">ë‚´ ìœ„ì¹˜ ì—…ë¡œë“œ</button>
  <button onclick="getLocation()">ìƒëŒ€ ìœ„ì¹˜ ì¡°íšŒ</button>

  <p id="status"></p>

  <script>
    // ğŸ”¹ Firebase ì„¤ì • (ìì‹ ì˜ í”„ë¡œì íŠ¸ ì •ë³´ë¡œ êµì²´)
    const firebaseConfig = {
    apiKey: "AIzaSyAOHwpN6pTIgFK2RkxYMNoCnkXaotTg6bY",
    authDomain: "retrofittester-4f36c.firebaseapp.com",
    databaseURL: "https://retrofittester-4f36c-default-rtdb.firebaseio.com",
    projectId: "retrofittester-4f36c",
    storageBucket: "retrofittester-4f36c.firebasestorage.app",
    messagingSenderId: "398490449949",
    appId: "1:398490449949:web:65fee5344c68ccb078aef4"
    };

    // Firebase ì´ˆê¸°í™”
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // âœ… ë‚´ ìœ„ì¹˜ ì—…ë¡œë“œ
    function uploadLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition((pos) => {
          const lat = pos.coords.latitude;
          const lng = pos.coords.longitude;

          // DBì— ì—…ë¡œë“œ
          firebase.database().ref("locations/userA").set({
            lat: lat,
            lng: lng,
            timestamp: Date.now()
          });

          document.getElementById("status").innerText = 
            `ì—…ë¡œë“œ ì™„ë£Œ: (${lat}, ${lng})`;
        });
      } else {
        alert("GPSë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ê¸°ê¸°ì…ë‹ˆë‹¤.");
      }
    }

    // âœ… ìƒëŒ€ ìœ„ì¹˜ ì¡°íšŒ
    function getLocation() {
      firebase.database().ref("locations/userA").once("value")
        .then(snapshot => {
          const data = snapshot.val();
          if (data) {
            document.getElementById("status").innerText =
              `ìƒëŒ€ ìœ„ì¹˜: (${data.lat}, ${data.lng})`;
          } else {
            document.getElementById("status").innerText = "ìœ„ì¹˜ ë°ì´í„° ì—†ìŒ";
          }
        });
    }
  </script>
</body>
</html>
